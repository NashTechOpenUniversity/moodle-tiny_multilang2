define("tiny_multilang2/ui",["exports","./options"],(function(_exports,_options){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.onPreProcess=_exports.onInit=_exports.onBeforeSetContent=_exports.onBeforeGetContent=_exports.applyLanguage=void 0;let _already_highlighted=0;const _span_fixed_attrs='class="multilang-begin mceNonEditable" data-mce-contenteditable="false"',_span_multilang_begin="<span "+_span_fixed_attrs+' lang="%lang" xml:lang="%lang">{mlang %lang}</span>',_span_multilang_end="<span "+_span_fixed_attrs.replace("begin","end")+">{mlang}</span>",_add_visual_styling=function(ed,content){if(_already_highlighted)return content;content||(content=ed.getContent());let begin_str=_span_multilang_begin;return content=(content=content.replace(new RegExp("{\\s*mlang\\s+([^}]+?)\\s*}","ig"),(function(match,p1){return begin_str.replace(new RegExp("%lang","g"),p1)}))).replace(new RegExp("{\\s*mlang\\s*}","ig"),_span_multilang_end),_already_highlighted=1,content},_remove_visual_styling=function(ed){_already_highlighted&&(["begin","end"].forEach((function(t){let nodes=ed.dom.select("span.multilang-"+t);for(let n=0,l=nodes.length;n<l;n++){const span=nodes[n];ed.dom.setOuterHTML(span,span.innerHTML.toLowerCase())}})),_already_highlighted=0)};_exports.onInit=function(ed){(0,_options.isContentToHighlight)(ed)&&(ed.dom.addStyle((0,_options.getHighlightCss)(ed)),ed.setContent(_add_visual_styling(ed,ed.getContent())))};_exports.onBeforeGetContent=function(ed,o){if(void 0!==o.source_view&&o.source_view){var onClose=function(window){var ed=window.editor;ed.windowManager.onClose.remove(onClose),ed.setContent(_add_visual_styling(ed,ed.getContent()))};ed.windowManager.onClose.add(onClose),(0,_options.isContentToHighlight)(ed)&&_remove_visual_styling(ed)}};_exports.onBeforeSetContent=function(ed,o){void 0!==o.source_view&&o.source_view&&(0,_options.isContentToHighlight)(ed)&&(o.content=_add_visual_styling(ed,o.content))};_exports.onPreProcess=function(ed,o){void 0!==o.save&&o.save&&(0,_options.isContentToHighlight)(ed)&&(_remove_visual_styling(ed),_already_highlighted=1)};_exports.applyLanguage=function(ed,iso){if(null===iso)return;let newtext,text=ed.selection.getContent();""!==text.toString().replace(/^\s+/,"").replace(/\s+$/,"")?(newtext=(0,_options.isContentToHighlight)(ed)?_span_multilang_begin.replace(new RegExp("%lang","g"),iso)+text+_span_multilang_end:"{mlang "+iso+"}"+text+"{mlang}",ed.selection.setContent(newtext)):(newtext=(0,_options.isContentToHighlight)(ed)?_span_multilang_begin.replace(new RegExp("%lang","g"),iso)+" "+_span_multilang_end:"{mlang "+iso+"} {mlang}",ed.insertContent(newtext))}}));

//# sourceMappingURL=ui.min.js.map